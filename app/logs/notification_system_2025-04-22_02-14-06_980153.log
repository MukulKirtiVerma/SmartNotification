2025-04-22T02:14:06.983181+0530 INFO Starting Smart Notification System
2025-04-22T02:14:13.671930+0530 INFO Database tables initialized
2025-04-22T02:14:13.671930+0530 INFO Agent dashboard_tracker_d3dd650e registered as dashboard_tracker
2025-04-22T02:14:13.671930+0530 INFO Agent dashboard_tracker_d3dd650e (Dashboard Tracker) initialized
2025-04-22T02:14:13.671930+0530 INFO Agent email_engagement_5cf2be59 registered as email_engagement
2025-04-22T02:14:13.671930+0530 INFO Agent email_engagement_5cf2be59 (Email Engagement Tracker) initialized
2025-04-22T02:14:13.673510+0530 INFO Agent mobile_app_events_ef589d01 registered as mobile_app_events
2025-04-22T02:14:13.673510+0530 INFO Agent mobile_app_events_ef589d01 (Mobile App Events Tracker) initialized
2025-04-22T02:14:13.673510+0530 INFO Agent sms_interaction_b7ce0132 registered as sms_interaction
2025-04-22T02:14:13.673510+0530 INFO Agent sms_interaction_b7ce0132 (SMS Interaction Tracker) initialized
2025-04-22T02:14:13.673510+0530 INFO Agent frequency_analysis_a5c8130b registered as frequency_analysis
2025-04-22T02:14:13.674546+0530 INFO Agent frequency_analysis_a5c8130b (Frequency Analysis) initialized
2025-04-22T02:14:13.674546+0530 INFO Agent type_analysis_70459302 registered as type_analysis
2025-04-22T02:14:13.674546+0530 INFO Agent type_analysis_70459302 (Type Analysis) initialized
2025-04-22T02:14:13.674546+0530 INFO Agent channel_analysis_6fbc0f5b registered as channel_analysis
2025-04-22T02:14:13.674546+0530 INFO Agent channel_analysis_6fbc0f5b (Channel Analysis) initialized
2025-04-22T02:14:13.674546+0530 INFO Agent user_profile_f0f020b3 registered as user_profile
2025-04-22T02:14:13.675544+0530 INFO Agent user_profile_f0f020b3 (User Profile Service) initialized
2025-04-22T02:14:13.675544+0530 INFO Agent recommendation_8d0e97c2 registered as recommendation
2025-04-22T02:14:13.675544+0530 INFO Agent recommendation_8d0e97c2 (Recommendation System) initialized
2025-04-22T02:14:13.675544+0530 INFO Agent ab_testing_7e3dad5b registered as ab_testing
2025-04-22T02:14:13.675544+0530 INFO Agent ab_testing_7e3dad5b (A/B Testing Module) initialized
2025-04-22T02:14:13.675544+0530 INFO Agent email_service_53f6b6a4 registered as email_service
2025-04-22T02:14:13.675544+0530 INFO Agent email_service_53f6b6a4 (Email Service) initialized
2025-04-22T02:14:13.675544+0530 INFO Agent push_notification_adc42e0f registered as push_notification
2025-04-22T02:14:13.676540+0530 INFO Agent push_notification_adc42e0f (Push Notification Service) initialized
2025-04-22T02:14:13.676540+0530 INFO Agent sms_gateway_38aea9ff registered as sms_gateway
2025-04-22T02:14:13.676540+0530 INFO Agent sms_gateway_38aea9ff (SMS Gateway) initialized
2025-04-22T02:14:13.676540+0530 INFO Agent dashboard_alert_2b71e626 registered as dashboard_alert
2025-04-22T02:14:13.676540+0530 INFO Agent dashboard_alert_2b71e626 (Dashboard Alert System) initialized
2025-04-22T02:14:13.676540+0530 INFO Starting 14 agents
2025-04-22T02:14:13.677539+0530 INFO All agents started
2025-04-22T02:14:13.677539+0530 INFO Smart Notification System started successfully
2025-04-22T02:14:13.677539+0530 INFO Agent dashboard_tracker_d3dd650e (Dashboard Tracker) starting
2025-04-22T02:14:13.677539+0530 DEBUG DashboardTrackerAgent dashboard_tracker_d3dd650e processing
2025-04-22T02:14:16.790010+0530 DEBUG Message delivered to 1 agents of type frequency_analysis
2025-04-22T02:14:18.212999+0530 DEBUG Message delivered to 1 agents of type type_analysis
2025-04-22T02:14:19.644329+0530 DEBUG Message delivered to 1 agents of type channel_analysis
2025-04-22T02:14:20.366579+0530 INFO Sent dashboard metrics for 0 users to analysis agents
2025-04-22T02:14:21.151854+0530 INFO Agent email_engagement_5cf2be59 (Email Engagement Tracker) starting
2025-04-22T02:14:21.151854+0530 DEBUG EmailEngagementAgent email_engagement_5cf2be59 processing
2025-04-22T02:14:21.967405+0530 ERROR Error processing email engagement: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 2, 'event_type': 'email_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 20, 22, 12, 389000)}}
2025-04-22T02:14:24.208253+0530 ERROR Error in agent email_engagement_5cf2be59: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 2, 'event_type': 'email_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 20, 22, 12, 389000)}}
2025-04-22T02:14:24.208253+0530 DEBUG Traceback (most recent call last):
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\base_agent.py", line 56, in start
    await self.process()
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\email_engagement.py", line 34, in process
    await self._process_recent_engagements(db)
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\email_engagement.py", line 80, in _process_recent_engagements
    self.user_events_collection.insert_one(event)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 628, in insert_one
    self._insert_one(
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 569, in _insert_one
    self.__database.client._retryable_write(acknowledged, _insert_command, session)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1476, in _retryable_write
    return self._retry_with_session(retryable, func, s, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1349, in _retry_with_session
    return self._retry_internal(retryable, func, session, bulk)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\_csot.py", line 105, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1390, in _retry_internal
    return func(session, sock_info, retryable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 567, in _insert_command
    _check_write_command_response(result)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 217, in _check_write_command_response
    _raise_last_write_error(write_errors)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 189, in _raise_last_write_error
    raise DuplicateKeyError(error.get("errmsg"), 11000, error)
pymongo.errors.DuplicateKeyError: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 2, 'event_type': 'email_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 20, 22, 12, 389000)}}

2025-04-22T02:14:24.208253+0530 INFO Agent mobile_app_events_ef589d01 (Mobile App Events Tracker) starting
2025-04-22T02:14:24.208253+0530 DEBUG MobileAppEventsAgent mobile_app_events_ef589d01 processing
2025-04-22T02:14:24.984336+0530 ERROR Error processing mobile app events: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 6, 'event_type': 'push_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 19, 52, 10, 647000)}}
2025-04-22T02:14:27.224868+0530 ERROR Error in agent mobile_app_events_ef589d01: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 6, 'event_type': 'push_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 19, 52, 10, 647000)}}
2025-04-22T02:14:27.226869+0530 DEBUG Traceback (most recent call last):
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\base_agent.py", line 56, in start
    await self.process()
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\mobile_app_events.py", line 34, in process
    await self._process_recent_engagements(db)
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\mobile_app_events.py", line 80, in _process_recent_engagements
    self.user_events_collection.insert_one(event)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 628, in insert_one
    self._insert_one(
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 569, in _insert_one
    self.__database.client._retryable_write(acknowledged, _insert_command, session)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1476, in _retryable_write
    return self._retry_with_session(retryable, func, s, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1349, in _retry_with_session
    return self._retry_internal(retryable, func, session, bulk)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\_csot.py", line 105, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1390, in _retry_internal
    return func(session, sock_info, retryable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 567, in _insert_command
    _check_write_command_response(result)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 217, in _check_write_command_response
    _raise_last_write_error(write_errors)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 189, in _raise_last_write_error
    raise DuplicateKeyError(error.get("errmsg"), 11000, error)
pymongo.errors.DuplicateKeyError: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 6, 'event_type': 'push_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 19, 52, 10, 647000)}}

2025-04-22T02:14:27.227867+0530 INFO Agent sms_interaction_b7ce0132 (SMS Interaction Tracker) starting
2025-04-22T02:14:27.227867+0530 DEBUG SMSInteractionAgent sms_interaction_b7ce0132 processing
2025-04-22T02:14:28.485780+0530 DEBUG Calculated SMS metrics for user 4: 0.0% response rate
2025-04-22T02:14:29.002620+0530 DEBUG Calculated SMS metrics for user 9: 100.0% response rate
2025-04-22T02:14:29.519091+0530 DEBUG Calculated SMS metrics for user 10: 20.0% response rate
2025-04-22T02:14:30.068018+0530 DEBUG Calculated SMS metrics for user 15: 25.0% response rate
2025-04-22T02:14:30.604241+0530 DEBUG Calculated SMS metrics for user 6: 0.0% response rate
2025-04-22T02:14:31.129685+0530 DEBUG Calculated SMS metrics for user 12: 0.0% response rate
2025-04-22T02:14:31.650957+0530 DEBUG Calculated SMS metrics for user 21: 0.0% response rate
2025-04-22T02:14:32.172049+0530 DEBUG Calculated SMS metrics for user 14: 0.0% response rate
2025-04-22T02:14:32.744607+0530 DEBUG Calculated SMS metrics for user 3: 0.0% response rate
2025-04-22T02:14:33.270548+0530 DEBUG Calculated SMS metrics for user 17: 0.0% response rate
2025-04-22T02:14:33.802027+0530 DEBUG Calculated SMS metrics for user 13: 0.0% response rate
2025-04-22T02:14:34.321995+0530 DEBUG Calculated SMS metrics for user 5: 0.0% response rate
2025-04-22T02:14:34.844268+0530 DEBUG Calculated SMS metrics for user 18: 0.0% response rate
2025-04-22T02:14:35.351074+0530 DEBUG Calculated SMS metrics for user 2: 0.0% response rate
2025-04-22T02:14:37.708500+0530 DEBUG Message delivered to 1 agents of type frequency_analysis
2025-04-22T02:14:39.281194+0530 DEBUG Message delivered to 1 agents of type channel_analysis
2025-04-22T02:14:40.864126+0530 DEBUG Message delivered to 1 agents of type type_analysis
2025-04-22T02:14:41.637104+0530 INFO Sent SMS metrics for 100 users to analysis agents
2025-04-22T02:14:42.453976+0530 INFO Agent frequency_analysis_a5c8130b (Frequency Analysis) starting
2025-04-22T02:14:43.259130+0530 INFO Received 0 dashboard metrics from Dashboard Tracker
2025-04-22T02:14:44.891923+0530 INFO Received 100 SMS engagement metrics from SMS Interaction Tracker
2025-04-22T02:14:49.799641+0530 DEBUG FrequencyAnalysisAgent frequency_analysis_a5c8130b processing
2025-04-22T02:14:50.891620+0530 DEBUG Updated frequency preferences for user 4: low (0.20)
2025-04-22T02:14:50.957991+0530 DEBUG Updated frequency preferences for user 9: medium (0.57)
2025-04-22T02:14:51.026074+0530 DEBUG Updated frequency preferences for user 10: very_low (0.15)
2025-04-22T02:14:51.092674+0530 DEBUG Updated frequency preferences for user 15: low (0.22)
2025-04-22T02:14:51.164397+0530 DEBUG Updated frequency preferences for user 6: medium (0.55)
2025-04-22T02:14:51.243910+0530 DEBUG Updated frequency preferences for user 12: medium (0.42)
2025-04-22T02:14:51.317272+0530 DEBUG Updated frequency preferences for user 21: very_low (0.00)
2025-04-22T02:14:51.400650+0530 DEBUG Updated frequency preferences for user 14: very_low (0.11)
2025-04-22T02:14:51.465382+0530 DEBUG Updated frequency preferences for user 3: medium (0.50)
2025-04-22T02:14:51.532841+0530 DEBUG Updated frequency preferences for user 17: low (0.35)
2025-04-22T02:14:51.600823+0530 DEBUG Updated frequency preferences for user 13: low (0.30)
2025-04-22T02:14:51.666921+0530 DEBUG Updated frequency preferences for user 5: low (0.35)
2025-04-22T02:14:51.738365+0530 DEBUG Updated frequency preferences for user 18: low (0.25)
2025-04-22T02:14:51.805789+0530 DEBUG Updated frequency preferences for user 2: low (0.20)
2025-04-22T02:14:51.876146+0530 DEBUG Updated frequency preferences for user 7: medium (0.49)
2025-04-22T02:14:51.943793+0530 DEBUG Updated frequency preferences for user 19: very_high (1.00)
2025-04-22T02:14:52.031210+0530 DEBUG Updated frequency preferences for user 20: low (0.30)
2025-04-22T02:14:52.107369+0530 DEBUG Updated frequency preferences for user 16: very_low (0.15)
2025-04-22T02:14:52.172316+0530 DEBUG Updated frequency preferences for user 11: very_high (1.00)
2025-04-22T02:14:52.243176+0530 DEBUG Updated frequency preferences for user 8: high (0.72)
2025-04-22T02:14:52.468825+0530 DEBUG Updated time preferences for user 2: peak period evening
2025-04-22T02:14:52.535646+0530 DEBUG Updated time preferences for user 5: peak period evening
2025-04-22T02:14:52.600476+0530 DEBUG Updated time preferences for user 6: peak period evening
2025-04-22T02:14:52.666862+0530 DEBUG Updated time preferences for user 7: peak period evening
2025-04-22T02:14:52.732212+0530 DEBUG Updated time preferences for user 8: peak period evening
2025-04-22T02:14:52.799332+0530 DEBUG Updated time preferences for user 10: peak period evening
2025-04-22T02:14:52.862651+0530 DEBUG Updated time preferences for user 13: peak period evening
2025-04-22T02:14:52.929648+0530 DEBUG Updated time preferences for user 17: peak period evening
2025-04-22T02:14:52.997972+0530 DEBUG Updated time preferences for user 9: peak period evening
2025-04-22T02:14:53.064794+0530 DEBUG Updated time preferences for user 11: peak period evening
2025-04-22T02:14:53.130095+0530 DEBUG Updated time preferences for user 12: peak period evening
2025-04-22T02:14:53.196216+0530 DEBUG Updated time preferences for user 20: peak period evening
2025-04-22T02:14:53.309738+0530 DEBUG Updated time preferences for user 21: peak period evening
2025-04-22T02:14:53.376123+0530 DEBUG Updated time preferences for user 3: peak period evening
2025-04-22T02:14:53.443374+0530 DEBUG Updated time preferences for user 4: peak period evening
2025-04-22T02:14:53.524277+0530 DEBUG Updated time preferences for user 19: peak period evening
2025-04-22T02:14:53.591810+0530 DEBUG Updated time preferences for user 15: peak period evening
2025-04-22T02:14:53.654785+0530 DEBUG Updated time preferences for user 16: peak period evening
2025-04-22T02:14:53.721292+0530 DEBUG Updated time preferences for user 18: peak period evening
2025-04-22T02:14:53.796454+0530 DEBUG Updated time preferences for user 14: peak period evening
2025-04-22T02:14:54.632502+0530 DEBUG Message delivered to 1 agents of type user_profile
2025-04-22T02:14:55.354849+0530 INFO Sent frequency recommendations for 20 users to User Profile Service
2025-04-22T02:14:56.064565+0530 INFO Agent type_analysis_70459302 (Type Analysis) starting
2025-04-22T02:14:56.817313+0530 INFO Received 0 dashboard section views from Dashboard Tracker
2025-04-22T02:14:58.323213+0530 INFO Received 0 notification type metrics from SMS Interaction Tracker
2025-04-22T02:14:59.045770+0530 DEBUG TypeAnalysisAgent type_analysis_70459302 processing
2025-04-22T02:14:59.178185+0530 DEBUG Updated content preferences for user 21: top type delivery
2025-04-22T02:14:59.246188+0530 DEBUG Updated content preferences for user 18: top type shipment
2025-04-22T02:14:59.312405+0530 DEBUG Updated content preferences for user 19: top type order_confirmation
2025-04-22T02:14:59.362318+0530 DEBUG Updated content preferences for user 15: top type delivery
2025-04-22T02:14:59.440738+0530 DEBUG Updated content preferences for user 5: top type promotion
2025-04-22T02:14:59.504670+0530 DEBUG Updated content preferences for user 11: top type packing
2025-04-22T02:14:59.567161+0530 DEBUG Updated content preferences for user 3: top type packing
2025-04-22T02:14:59.645457+0530 DEBUG Updated content preferences for user 13: top type packing
2025-04-22T02:14:59.708353+0530 DEBUG Updated content preferences for user 10: top type return
2025-04-22T02:14:59.770841+0530 DEBUG Updated content preferences for user 17: top type promotion
2025-04-22T02:14:59.839147+0530 DEBUG Updated content preferences for user 9: top type promotion
2025-04-22T02:14:59.911386+0530 DEBUG Updated content preferences for user 20: top type promotion
2025-04-22T02:14:59.976266+0530 DEBUG Updated content preferences for user 14: top type packing
2025-04-22T02:15:00.039414+0530 DEBUG Updated content preferences for user 7: top type price_drop
2025-04-22T02:15:00.102064+0530 DEBUG Updated content preferences for user 4: top type delivery
2025-04-22T02:15:00.166578+0530 DEBUG Updated content preferences for user 12: top type price_drop
2025-04-22T02:15:00.227462+0530 DEBUG Updated content preferences for user 2: top type promotion
2025-04-22T02:15:00.290110+0530 DEBUG Updated content preferences for user 8: top type restock
2025-04-22T02:15:00.363185+0530 DEBUG Updated content preferences for user 6: top type order_confirmation
2025-04-22T02:15:01.109996+0530 DEBUG Message delivered to 1 agents of type user_profile
2025-04-22T02:15:01.866034+0530 INFO Sent content recommendations for 20 users to User Profile Service
2025-04-22T02:15:02.620092+0530 INFO Agent channel_analysis_6fbc0f5b (Channel Analysis) starting
2025-04-22T02:15:03.438081+0530 INFO Received 0 channel engagements from Dashboard Tracker
2025-04-22T02:15:04.955937+0530 INFO Received 100 channel engagements from SMS Interaction Tracker
2025-04-22T02:15:09.588693+0530 DEBUG ChannelAnalysisAgent channel_analysis_6fbc0f5b processing
2025-04-22T02:15:10.052365+0530 DEBUG Updated channel preferences for user 2: top channel email
2025-04-22T02:15:10.117862+0530 DEBUG Updated channel preferences for user 18: top channel email
2025-04-22T02:15:10.183721+0530 DEBUG Updated channel preferences for user 5: top channel email
2025-04-22T02:15:10.250333+0530 DEBUG Updated channel preferences for user 13: top channel email
2025-04-22T02:15:10.314372+0530 DEBUG Updated channel preferences for user 17: top channel email
2025-04-22T02:15:10.385351+0530 DEBUG Updated channel preferences for user 3: top channel email
2025-04-22T02:15:10.452214+0530 DEBUG Updated channel preferences for user 14: top channel push
2025-04-22T02:15:10.516075+0530 DEBUG Updated channel preferences for user 21: top channel email
2025-04-22T02:15:10.576357+0530 DEBUG Updated channel preferences for user 12: top channel email
2025-04-22T02:15:10.639354+0530 DEBUG Updated channel preferences for user 6: top channel push
2025-04-22T02:15:10.707735+0530 DEBUG Updated channel preferences for user 15: top channel sms
2025-04-22T02:15:10.771566+0530 DEBUG Updated channel preferences for user 10: top channel sms
2025-04-22T02:15:10.835394+0530 DEBUG Updated channel preferences for user 9: top channel sms
2025-04-22T02:15:10.926685+0530 DEBUG Updated channel preferences for user 4: top channel email
2025-04-22T02:15:10.991635+0530 DEBUG Updated channel preferences for user 8: top channel push
2025-04-22T02:15:11.061961+0530 DEBUG Updated channel preferences for user 11: top channel email
2025-04-22T02:15:11.125469+0530 DEBUG Updated channel preferences for user 16: top channel email
2025-04-22T02:15:11.189298+0530 DEBUG Updated channel preferences for user 20: top channel email
2025-04-22T02:15:11.259635+0530 DEBUG Updated channel preferences for user 19: top channel email
2025-04-22T02:15:11.323815+0530 DEBUG Updated channel preferences for user 7: top channel email
2025-04-22T02:15:12.125185+0530 DEBUG Message delivered to 1 agents of type user_profile
2025-04-22T02:15:12.919257+0530 INFO Sent channel recommendations for 20 users to User Profile Service
2025-04-22T02:15:13.656483+0530 INFO Agent user_profile_f0f020b3 (User Profile Service) starting
2025-04-22T02:15:14.359486+0530 INFO Received frequency recommendations for 20 users from Frequency Analysis
2025-04-22T02:15:16.542327+0530 INFO Received content recommendations for 20 users from Type Analysis
2025-04-22T02:15:18.776089+0530 INFO Received channel recommendations for 20 users from Channel Analysis
2025-04-22T02:15:20.170167+0530 DEBUG UserProfileAgent user_profile_f0f020b3 processing
2025-04-22T02:15:20.365168+0530 INFO Merging updates for 20 user profiles
2025-04-22T02:15:20.498667+0530 DEBUG Updated segments for user 2: ['frequency_low', 'prefers_email', 'prefers_promotion', 'active_evening']
2025-04-22T02:15:20.545722+0530 DEBUG Updated segments for user 3: ['frequency_medium', 'prefers_email', 'prefers_packing', 'active_evening']
2025-04-22T02:15:20.588425+0530 DEBUG Updated segments for user 4: ['frequency_low', 'prefers_email', 'prefers_delivery', 'active_evening']
2025-04-22T02:15:20.626777+0530 DEBUG Updated segments for user 5: ['frequency_low', 'prefers_email', 'prefers_promotion', 'active_evening']
2025-04-22T02:15:20.664679+0530 DEBUG Updated segments for user 6: ['frequency_medium', 'prefers_push', 'prefers_order_confirmation', 'active_evening']
2025-04-22T02:15:20.703592+0530 DEBUG Updated segments for user 7: ['frequency_medium', 'prefers_email', 'prefers_price_drop', 'active_evening']
2025-04-22T02:15:20.741653+0530 DEBUG Updated segments for user 8: ['frequency_high', 'prefers_push', 'prefers_restock', 'active_evening']
2025-04-22T02:15:20.777811+0530 DEBUG Updated segments for user 9: ['frequency_medium', 'prefers_sms', 'prefers_promotion', 'active_evening']
2025-04-22T02:15:20.835659+0530 DEBUG Updated segments for user 10: ['frequency_very_low', 'prefers_sms', 'prefers_return', 'active_evening']
2025-04-22T02:15:20.871561+0530 DEBUG Updated segments for user 11: ['frequency_very_high', 'prefers_email', 'prefers_packing', 'active_evening']
2025-04-22T02:15:20.908464+0530 DEBUG Updated segments for user 12: ['frequency_medium', 'prefers_email', 'prefers_price_drop', 'active_evening']
2025-04-22T02:15:20.942374+0530 DEBUG Updated segments for user 13: ['frequency_low', 'prefers_email', 'prefers_packing', 'active_evening']
2025-04-22T02:15:20.977626+0530 DEBUG Updated segments for user 14: ['frequency_very_low', 'prefers_push', 'prefers_packing', 'active_evening']
2025-04-22T02:15:21.011163+0530 DEBUG Updated segments for user 15: ['frequency_low', 'prefers_sms', 'prefers_delivery', 'active_evening']
2025-04-22T02:15:21.046073+0530 DEBUG Updated segments for user 16: ['frequency_very_low', 'prefers_email', 'prefers_promotion', 'active_evening']
2025-04-22T02:15:21.083965+0530 DEBUG Updated segments for user 17: ['frequency_low', 'prefers_email', 'prefers_promotion', 'active_evening']
2025-04-22T02:15:21.131497+0530 DEBUG Updated segments for user 18: ['frequency_low', 'prefers_email', 'prefers_shipment', 'active_evening']
2025-04-22T02:15:21.167399+0530 DEBUG Updated segments for user 19: ['frequency_very_high', 'prefers_email', 'prefers_order_confirmation', 'active_evening']
2025-04-22T02:15:21.216790+0530 DEBUG Updated segments for user 20: ['frequency_low', 'prefers_email', 'prefers_promotion', 'active_evening']
2025-04-22T02:15:21.250695+0530 DEBUG Updated segments for user 21: ['frequency_very_low', 'prefers_email', 'prefers_delivery', 'active_evening']
2025-04-22T02:15:22.073208+0530 DEBUG Message delivered to 1 agents of type recommendation
2025-04-22T02:15:22.832117+0530 INFO Sent 20 updated profiles to Recommendation System
2025-04-22T02:15:23.615214+0530 INFO Agent recommendation_8d0e97c2 (Recommendation System) starting
2025-04-22T02:15:24.331344+0530 INFO Received 20 updated profiles from User Profile Service
2025-04-22T02:15:26.125899+0530 DEBUG RecommendationAgent recommendation_8d0e97c2 processing
2025-04-22T02:15:26.255246+0530 INFO A/B test 1: Variant variant_a outperformed control for metric open_rate
2025-04-22T02:15:27.066072+0530 ERROR Error in agent recommendation_8d0e97c2: 'Session' object has no attribute 'models'
2025-04-22T02:15:27.067036+0530 DEBUG Traceback (most recent call last):
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\base_agent.py", line 56, in start
    await self.process()
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\decision_engine\recommendation.py", line 35, in process
    await self._check_ab_test_results()
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\decision_engine\recommendation.py", line 128, in _check_ab_test_results
    await self._update_strategies_from_test(test_id, variant, result)
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\decision_engine\recommendation.py", line 241, in _update_strategies_from_test
    ab_test = db.query(db.models.ABTest).filter_by(id=test_id).first()
                       ^^^^^^^^^
AttributeError: 'Session' object has no attribute 'models'

2025-04-22T02:15:27.067036+0530 INFO Agent ab_testing_7e3dad5b (A/B Testing Module) starting
2025-04-22T02:15:27.067036+0530 DEBUG ABTestingAgent ab_testing_7e3dad5b processing
2025-04-22T02:15:28.492227+0530 WARNING No eligible users found for A/B test Email Subject Line Test (ID: 1)
2025-04-22T02:15:29.195891+0530 WARNING No eligible users found for A/B test Notification Timing Test (ID: 2)
2025-04-22T02:15:30.374819+0530 WARNING No eligible users found for A/B test Channel Preference Test (ID: 3)
2025-04-22T02:15:30.616141+0530 INFO Analyzing results for A/B test Email Subject Line Test (ID: 1)
2025-04-22T02:15:33.622386+0530 INFO Updated results for test 1, metric open_rate: {'control': 0.25, 'variant_a': 0.3076923076923077, 'variant_b': 0.36036036036036034}
2025-04-22T02:15:36.109886+0530 INFO Updated results for test 1, metric click_rate: {'control': 0.17592592592592593, 'variant_a': 0.17307692307692307, 'variant_b': 0.1891891891891892}
2025-04-22T02:15:36.110849+0530 INFO Analyzing results for A/B test Notification Timing Test (ID: 2)
2025-04-22T02:15:38.737389+0530 INFO Updated results for test 2, metric open_rate: {'control': 0.3333333333333333, 'variant_a': 0.2545454545454545, 'variant_b': 0.3106060606060606}
2025-04-22T02:15:39.009894+0530 INFO Updated results for test 2, metric engagement_score: {'control': 0.23975694444444443, 'variant_a': 0.2833333333333333, 'variant_b': 0.29958333333333337}
2025-04-22T02:15:40.027747+0530 INFO Agent email_service_53f6b6a4 (Email Service) starting
2025-04-22T02:15:40.027747+0530 DEBUG EmailServiceAgent email_service_53f6b6a4 processing
2025-04-22T02:15:40.751369+0530 INFO Agent push_notification_adc42e0f (Push Notification Service) starting
2025-04-22T02:15:40.751369+0530 DEBUG PushNotificationAgent push_notification_adc42e0f processing
2025-04-22T02:15:41.446768+0530 INFO Agent sms_gateway_38aea9ff (SMS Gateway) starting
2025-04-22T02:15:41.447567+0530 DEBUG SMSGatewayAgent sms_gateway_38aea9ff processing
2025-04-22T02:15:42.198414+0530 INFO Agent dashboard_alert_2b71e626 (Dashboard Alert System) starting
2025-04-22T02:15:42.199405+0530 DEBUG DashboardAlertAgent dashboard_alert_2b71e626 processing
2025-04-22T02:15:43.070620+0530 DEBUG DashboardTrackerAgent dashboard_tracker_d3dd650e processing
2025-04-22T02:15:44.487312+0530 DEBUG Message delivered to 1 agents of type frequency_analysis
2025-04-22T02:15:46.598690+0530 DEBUG Message delivered to 1 agents of type type_analysis
2025-04-22T02:15:48.176526+0530 DEBUG Message delivered to 1 agents of type channel_analysis
2025-04-22T02:15:48.955408+0530 INFO Sent dashboard metrics for 0 users to analysis agents
2025-04-22T02:15:49.660408+0530 DEBUG EmailEngagementAgent email_engagement_5cf2be59 processing
2025-04-22T02:15:50.413043+0530 ERROR Error processing email engagement: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 2, 'event_type': 'email_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 20, 22, 12, 389000)}}
2025-04-22T02:15:51.194623+0530 ERROR Error in agent email_engagement_5cf2be59: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 2, 'event_type': 'email_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 20, 22, 12, 389000)}}
2025-04-22T02:15:51.196412+0530 DEBUG Traceback (most recent call last):
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\base_agent.py", line 56, in start
    await self.process()
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\email_engagement.py", line 34, in process
    await self._process_recent_engagements(db)
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\email_engagement.py", line 80, in _process_recent_engagements
    self.user_events_collection.insert_one(event)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 628, in insert_one
    self._insert_one(
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 569, in _insert_one
    self.__database.client._retryable_write(acknowledged, _insert_command, session)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1476, in _retryable_write
    return self._retry_with_session(retryable, func, s, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1349, in _retry_with_session
    return self._retry_internal(retryable, func, session, bulk)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\_csot.py", line 105, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1390, in _retry_internal
    return func(session, sock_info, retryable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 567, in _insert_command
    _check_write_command_response(result)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 217, in _check_write_command_response
    _raise_last_write_error(write_errors)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 189, in _raise_last_write_error
    raise DuplicateKeyError(error.get("errmsg"), 11000, error)
pymongo.errors.DuplicateKeyError: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 2, event_type: "email_engagement", timestamp: new Date(1745266932389) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 2, 'event_type': 'email_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 20, 22, 12, 389000)}}

2025-04-22T02:15:51.197442+0530 DEBUG MobileAppEventsAgent mobile_app_events_ef589d01 processing
2025-04-22T02:15:51.895367+0530 ERROR Error processing mobile app events: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 6, 'event_type': 'push_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 19, 52, 10, 647000)}}
2025-04-22T02:15:52.689246+0530 ERROR Error in agent mobile_app_events_ef589d01: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 6, 'event_type': 'push_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 19, 52, 10, 647000)}}
2025-04-22T02:15:52.691242+0530 DEBUG Traceback (most recent call last):
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\base_agent.py", line 56, in start
    await self.process()
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\mobile_app_events.py", line 34, in process
    await self._process_recent_engagements(db)
  File "C:\Users\mukul\SmartNotification\SmartNotification\app\agents\data_collection\mobile_app_events.py", line 80, in _process_recent_engagements
    self.user_events_collection.insert_one(event)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 628, in insert_one
    self._insert_one(
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 569, in _insert_one
    self.__database.client._retryable_write(acknowledged, _insert_command, session)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1476, in _retryable_write
    return self._retry_with_session(retryable, func, s, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1349, in _retry_with_session
    return self._retry_internal(retryable, func, session, bulk)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\_csot.py", line 105, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\mongo_client.py", line 1390, in _retry_internal
    return func(session, sock_info, retryable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\collection.py", line 567, in _insert_command
    _check_write_command_response(result)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 217, in _check_write_command_response
    _raise_last_write_error(write_errors)
  File "C:\Users\mukul\SmartNotification\SmartNotification\.venv\Lib\site-packages\pymongo\helpers.py", line 189, in _raise_last_write_error
    raise DuplicateKeyError(error.get("errmsg"), 11000, error)
pymongo.errors.DuplicateKeyError: E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }, full error: {'index': 0, 'code': 11000, 'errmsg': 'E11000 duplicate key error collection: notification_system.user_events index: user_id_1_event_type_1_timestamp_1 dup key: { user_id: 6, event_type: "push_engagement", timestamp: new Date(1745265130647) }', 'keyPattern': {'user_id': 1, 'event_type': 1, 'timestamp': 1}, 'keyValue': {'user_id': 6, 'event_type': 'push_engagement', 'timestamp': datetime.datetime(2025, 4, 21, 19, 52, 10, 647000)}}

2025-04-22T02:15:52.691242+0530 DEBUG SMSInteractionAgent sms_interaction_b7ce0132 processing
2025-04-22T02:15:54.655074+0530 DEBUG Calculated SMS metrics for user 4: 0.0% response rate
2025-04-22T02:15:55.187133+0530 DEBUG Calculated SMS metrics for user 9: 100.0% response rate
2025-04-22T02:15:55.713226+0530 DEBUG Calculated SMS metrics for user 10: 20.0% response rate
2025-04-22T02:15:56.241970+0530 DEBUG Calculated SMS metrics for user 15: 25.0% response rate
2025-04-22T02:15:56.773412+0530 DEBUG Calculated SMS metrics for user 6: 0.0% response rate
2025-04-22T02:15:57.303414+0530 DEBUG Calculated SMS metrics for user 12: 0.0% response rate
2025-04-22T02:15:57.834433+0530 DEBUG Calculated SMS metrics for user 21: 0.0% response rate
2025-04-22T02:15:58.361244+0530 DEBUG Calculated SMS metrics for user 14: 0.0% response rate
2025-04-22T02:15:58.923052+0530 DEBUG Calculated SMS metrics for user 3: 0.0% response rate
2025-04-22T02:15:59.453467+0530 DEBUG Calculated SMS metrics for user 17: 0.0% response rate
2025-04-22T02:15:59.990934+0530 DEBUG Calculated SMS metrics for user 13: 0.0% response rate
2025-04-22T02:16:00.525894+0530 DEBUG Calculated SMS metrics for user 5: 0.0% response rate
2025-04-22T02:16:01.052313+0530 DEBUG Calculated SMS metrics for user 18: 0.0% response rate
2025-04-22T02:16:01.585855+0530 DEBUG Calculated SMS metrics for user 2: 0.0% response rate
2025-04-22T02:16:02.402862+0530 DEBUG Message delivered to 1 agents of type frequency_analysis
2025-04-22T02:16:03.842215+0530 DEBUG Message delivered to 1 agents of type channel_analysis
